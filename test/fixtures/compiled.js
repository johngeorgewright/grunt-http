var request=require("request");
module.exports=function(b){function f(a,e,d){return function(g,c,f){c=c||{statusCode:0};b.log.subhead("Response");if(g&&!d)return b.fail.fatal(g),a(g);if(!d&&(200>c.statusCode||299<c.statusCode))return b.fail.fatal(c.statusCode),a(c.statusCode);b.log.ok(c.statusCode);e&&b.file.write(e,f);a()}}b.registerMultiTask("http","Sends a HTTP request and deals with the response.",function(){var a=this.data,e=this.async(),d=!1;a.dest&&(d=a.dest,delete a.dest);a.url||b.fail.fatal("The http task requires a URL");b.log.subhead("Request");
b.log.writeln(JSON.stringify(a,null,2));request(a,f(e,d,a.ignoreErrors))})};
